kernel="gaussian"),
main="bw.CvL")
plot(density(clinic_seoul.km,
sigma=bw.scott,
edge=TRUE,
kernel="gaussian"),
main="bw.scott")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="bw.ppl")
plot(density(clinic_seoul.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="bw.diggle")
par(mfrow=c(2,2))
plot(density(hospital_seoul.km,
sigma=bw.CvL,
edge=TRUE,
kernel="gaussian"),
main="bw.CvL")
plot(density(hospital_seoul.km,
sigma=bw.scott,
edge=TRUE,
kernel="gaussian"),
main="bw.scott")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="bw.ppl")
plot(density(hospital_seoul.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="bw.diggle")
par(mfrow=c(2,2))
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="Gaussian")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="epanechnikov"),
main="Epanechnikov")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="quartic"),
main="Quartic")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="disc"),
main="Disc")
par(mfrow=c(2,2))
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="Gaussian")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="epanechnikov"),
main="Epanechnikov")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="quartic"),
main="Quartic")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="disc"),
main="Disc")
kde_clinics_bw <- density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian")
plot(kde_clinics_bw)
kde_hospitals_bw <- density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian")
plot(kde_hospitals_bw)
gridded_kde_clinic_bw <- as.SpatialGridDataFrame.im(kde_clinics_bw)
spplot(gridded_kde_childcareSG_bw)
gridded_kde_hospital_bw <- as.SpatialGridDataFrame.im(kde_hospitals_bw)
spplot(gridded_kde_hospital_bw)
kde_clinic_bw_raster <- raster(gridded_kde_clinic_bw)
kde_hospital_bw_raster <- raster(gridded_kde_hospital_bw)
kde_clinic_bw_raster
kde_hospital_bw_raster
projection(kde_clinic_bw_raster) <- CRS("+init=EPSG:5179")
kde_clinic_bw_raster
projection(kde_hospital_bw_raster) <- CRS("+init=EPSG:5179")
kde_hospital_bw_raster
tmap_mode('plot')
tm_shape(kde_clinic_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
tmap_mode('plot')
tm_shape(kde_hospital_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
seoul <- st_read(dsn = "data_final/seoul_adm2",
layer= "seoul_adm2") %>%
st_transform(crs = 5179)
clinics <- st_read(dsn = "data_final/seoul_clinics",
layer = "seoul_clinics") %>%
st_transform(crs = 5179)
hospitals <- st_read(dsn = "data_final/seoul_hospitals",
layer = "seoul_hospitals") %>%
st_transform(crs = 5179)
residence <- st_read(dsn = "data_final/seoul_residential",
layer = "seoul_residential") %>%
st_transform(crs = 5179)
road <- st_read(dsn="data_final/seoul_roads",
layer = "seoul_roads")%>%
st_transform(crs = 5179)
gu <- list('Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% gu)
qtm(seoul_gu)
tmap_mode("view")
qtm(seoul_gu,
fill = "population",
text= "name_en",
text.size = 0.5)
tmap_mode("view")
qtm(seoul_gu,
fill = "population",
text= "name_en",
text.size = 0.8)
clinics <- as_Spatial(clinics)
hospitals <- as_Spatial(hospitals)
hospitals <- gCentroid(hospitals, byid = T)
clinics_sp <- as(clinics, "SpatialPoints")
hospitals_sp <- as(hospitals, "SpatialPoints")
clinics_sp
hospitals_sp
clinics_ppp <- as(clinics_sp, "ppp")
hospitals_ppp <- as(hospitals_sp, "ppp")
any(duplicated(clinics_ppp))
any(duplicated(hospitals_ppp))
tmap_mode('view')
tm_shape(seoul) +
tm_dots(alpha=0.4,
size=0.05)
tmap_mode('view')
tm_shape(hospitals_ppp) +
tm_dots(alpha=0.4,
size=0.05)
seoul_outer <- st_read(dsn = "data_final/korea_polygon/korea",
layer= "KOR_adm1") %>%
st_transform(crs = 5179) %>% filter(NAME_1 == "Seoul")
seoul <- as_Spatial(seoul_gu)
seoul_sp <- as(seoul, "SpatialPolygons")
seoul_owin <- as(seoul_sp, "owin")
plot(seoul_owin)
clinic_seoul = clinics_ppp[seoul_owin]
hospital_seoul = hospitals_ppp[seoul_owin]
summary(clinic_seoul)
plot(clinic_seoul)
plot(hospital_seoul)
clinic_seoul.km <- rescale(clinic_seoul, 1000, "km")
hospital_seoul.km <- rescale(hospital_seoul, 1000, "km")
bw.CvL(clinic_seoul.km)
bw.scott(clinic_seoul.km)
bw.ppl(clinic_seoul.km)
bw.diggle(clinic_seoul.km)
bw.CvL(hospital_seoul.km)
bw.scott(hospital_seoul.km)
bw.ppl(hospital_seoul.km)
bw.diggle(hospital_seoul.km)
par(mfrow=c(2,2))
plot(density(clinic_seoul.km,
sigma=bw.CvL,
edge=TRUE,
kernel="gaussian"),
main="bw.CvL")
plot(density(clinic_seoul.km,
sigma=bw.scott,
edge=TRUE,
kernel="gaussian"),
main="bw.scott")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="bw.ppl")
plot(density(clinic_seoul.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="bw.diggle")
bw.CvL(hospital_seoul.km)
bw.scott(hospital_seoul.km)
bw.ppl(hospital_seoul.km)
bw.diggle(hospital_seoul.km)
par(mfrow=c(2,2))
plot(density(clinic_seoul.km,
sigma=bw.CvL,
edge=TRUE,
kernel="gaussian"),
main="bw.CvL")
plot(density(clinic_seoul.km,
sigma=bw.scott,
edge=TRUE,
kernel="gaussian"),
main="bw.scott")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="bw.ppl")
plot(density(clinic_seoul.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="bw.diggle")
par(mfrow=c(2,2))
plot(density(hospital_seoul.km,
sigma=bw.CvL,
edge=TRUE,
kernel="gaussian"),
main="bw.CvL")
plot(density(hospital_seoul.km,
sigma=bw.scott,
edge=TRUE,
kernel="gaussian"),
main="bw.scott")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="bw.ppl")
plot(density(hospital_seoul.km,
sigma=bw.diggle,
edge=TRUE,
kernel="gaussian"),
main="bw.diggle")
plot(hospital_seoul)
par(mfrow=c(2,2))
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="Gaussian")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="epanechnikov"),
main="Epanechnikov")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="quartic"),
main="Quartic")
plot(density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="disc"),
main="Disc")
par(mfrow=c(2,2))
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian"),
main="Gaussian")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="epanechnikov"),
main="Epanechnikov")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="quartic"),
main="Quartic")
plot(density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="disc"),
main="Disc")
kde_clinics_bw <- density(clinic_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian")
plot(kde_clinics_bw)
kde_hospitals_bw <- density(hospital_seoul.km,
sigma=bw.ppl,
edge=TRUE,
kernel="gaussian")
plot(kde_hospitals_bw)
gridded_kde_clinic_bw <- as.SpatialGridDataFrame.im(kde_clinics_bw)
spplot(gridded_kde_childcareSG_bw)
gridded_kde_clinic_bw <- as.SpatialGridDataFrame.im(kde_clinics_bw)
spplot(gridded_kde_clinic_bw)
gridded_kde_hospital_bw <- as.SpatialGridDataFrame.im(kde_hospitals_bw)
spplot(gridded_kde_hospital_bw)
kde_clinic_bw_raster <- raster(gridded_kde_clinic_bw)
kde_hospital_bw_raster <- raster(gridded_kde_hospital_bw)
kde_clinic_bw_raster
kde_hospital_bw_raster
projection(kde_clinic_bw_raster) <- CRS("+init=EPSG:5179")
kde_clinic_bw_raster
projection(kde_hospital_bw_raster) <- CRS("+init=EPSG:5179")
kde_hospital_bw_raster
tmap_mode('plot')
tm_shape(kde_clinic_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
tmap_mode('plot')
tm_shape(kde_hospital_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
tmap_mode('plot')
clinic_densmap <- tm_shape(kde_clinic_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
tmap_mode('plot')
clinic_densmap <- tm_shape(kde_clinic_bw_raster) +
tm_raster("v") +
tm_layout(legend.position = c("right", "bottom"), frame = FALSE)
clinic_densmap
par(mfrow=c(1,2))
plot(clinic_seoul)
clinic_densmap
par(mfrow=c(2,1))
plot(clinic_seoul)
clinic_densmap
plot(clinic_seoul)
clinic_densmap
clinics <- st_read(dsn = "data_final/seoul_clinics",
layer = "seoul_clinics") %>%
st_transform(crs = 5179)
hospitals <- st_read(dsn = "data_final/seoul_hospitals",
layer = "seoul_hospitals") %>%
st_transform(crs = 5179)
residence <- st_read(dsn = "data_final/seoul_residential",
layer = "seoul_residential") %>%
st_transform(crs = 5179)
View(hospitals)
clarkevans.test(clinic_seoul,
correction="none",
clipregion="seoul_owin",
alternative=c("clustered"),
nsim=99)
clarkevans.test(clinic_seoul,
correction="none",
clipregion="seoul_owin",
alternative=c("clustered"),
nsim=999)
clarkevans.test(clinic_seoul,
correction="none",
clipregion="seoul_owin",
alternative=c("two.sided"),
nsim=999)
clarkevans.test(clinic_seoul,
correction="none",
clipregion="seoul_owin",
alternative=c("clustered"),
nsim=999)
clarkevans.test(hospital_seoul,
correction="none",
clipregion="seoul_owin",
alternative=c("clustered"),
nsim=999)
K_ck = Kest(clinic_seoul, correction = "Ripley")
plot(K_ck, . -r ~ r, ylab= "K(d)-r", xlab = "d(m)")
K_ck.csr <- envelope(clinic_seoul, Kest, nsim = 99, rank = 1, glocal=TRUE)
K_clinic = Kest(clinic_seoul, correction = "Ripley")
plot(K_ck, . -r ~ r, ylab= "K(d)-r", xlab = "d(m)")
K_clinic.csr <- envelope(clinic_seoul, Kest, nsim = 99, rank = 1, glocal=TRUE)
plot(K_clinic.csr, . - r ~ r, xlab="d", ylab="K(d)-r")
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
seoul <- st_read(dsn = "data_final/seoul_adm2",
layer= "seoul_adm2") %>%
st_transform(crs = 5179)
clinics <- st_read(dsn = "data_final/seoul_clinics",
layer = "seoul_clinics") %>%
st_transform(crs = 5179)
hospitals <- st_read(dsn = "data_final/seoul_hospitals",
layer = "seoul_hospitals") %>%
st_transform(crs = 5179)
residence <- st_read(dsn = "data_final/seoul_residential",
layer = "seoul_residential") %>%
st_transform(crs = 5179)
road <- st_read(dsn="data_final/seoul_roads",
layer = "seoul_roads")%>%
st_transform(crs = 5179)
gu <- list('Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% gu)
gu <- list('Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% gu)
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
seoul_gu <- seoul %>%
filter(name_en %in% gu)
View(gu)
View(seoul)
seoul_gu <- seoul %>%
filter(name_en %in% gu)
seoul_gu <- seoul %>%
filter(name_en %in% as.numeric(unlist(gu)))
seoul_gu <- seoul %>%
filter(name_en %in% unlist(gu))
seoul_gu <- seoul %>%
filter(name_en %in% unlist(gu))
seoul_gu <- seoul %>%
filter(name_en %in% unlist(gu))
seoul_gu <- seoul %>%
filter(name_en %in% as.double(unlist(gu)))
seoul_gu <- seoul %>%
filter(name_en %in% as.double(unlist(gu)))
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
seoul <- st_read(dsn = "data_final/seoul_adm2",
layer= "seoul_adm2") %>%
st_transform(crs = 5179)
clinics <- st_read(dsn = "data_final/seoul_clinics",
layer = "seoul_clinics") %>%
st_transform(crs = 5179)
hospitals <- st_read(dsn = "data_final/seoul_hospitals",
layer = "seoul_hospitals") %>%
st_transform(crs = 5179)
residence <- st_read(dsn = "data_final/seoul_residential",
layer = "seoul_residential") %>%
st_transform(crs = 5179)
road <- st_read(dsn="data_final/seoul_roads",
layer = "seoul_roads")%>%
st_transform(crs = 5179)
gu <- list('Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% as.double(unlist(gu)))
seoul_gu <- seoul %>%
filter(name_en %in% gu)
seoul_gu <- seoul %>%
filter(name_en %in% 'Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% gu)
seoul_gu <- seoul %>%
filter(name_en %in% unlist(gu))
seoul_gu <- seoul %>%
filter(name_en %in% as.double(gu))
seoul_gu <- seoul %>%
filter(name_en %in% as.character(gu))
seoul_gu <- seoul %>%
filter(name_en %in% as.character(unlist(gu)
seoul_gu <- seoul %>%
filter(name_en %in% as.character(unlist(gu)))
clinics <- as_Spatial(clinics)
hospitals <- as_Spatial(hospitals)
hospitals <- gCentroid(hospitals, byid = T)
clinics_sp <- as(clinics, "SpatialPoints")
hospitals_sp <- as(hospitals, "SpatialPoints")
hospitals <- gCentroid(hospitals, byid = T)
clinics_sp <- as(clinics, "SpatialPoints")
hospitals_sp <- as(hospitals, "SpatialPoints")
clinics_sp
hospitals_sp
clinics_ppp <- as(clinics_sp, "ppp")
hospitals_ppp <- as(hospitals_sp, "ppp")
any(duplicated(clinics_ppp))
any(duplicated(hospitals_ppp))
seoul_outer <- st_read(dsn = "data_final/korea_polygon/korea",
layer= "KOR_adm1") %>%
st_transform(crs = 5179) %>% filter(NAME_1 == "Seoul")
pacman::p_load(maptools, sf, raster, spatstat, tmap, rgeos, rgdal,moments)
seoul <- st_read(dsn = "data_final/seoul_adm2",
layer= "seoul_adm2") %>%
st_transform(crs = 5179)
clinics <- st_read(dsn = "data_final/seoul_clinics",
layer = "seoul_clinics") %>%
st_transform(crs = 5179)
hospitals <- st_read(dsn = "data_final/seoul_hospitals",
layer = "seoul_hospitals") %>%
st_transform(crs = 5179)
residence <- st_read(dsn = "data_final/seoul_residential",
layer = "seoul_residential") %>%
st_transform(crs = 5179)
road <- st_read(dsn="data_final/seoul_roads",
layer = "seoul_roads")%>%
st_transform(crs = 5179)
gu <- list('Yeongdeungpo-gu', 'Yangcheon-gu','Seocho-gu','Gwanak-gu','
Guro-gu','Geumcheon-gu', 'Gangseo-gu','Dongjak-gu','Gangnam-gu','Yongsan-gu','Songpa-gu','Seongdong-gu','Seongbuk-gu','Seodaemun-gu','Nowon-gu','Mapo-gu','Jungnang-gu','Jung-gu','Jongno-gu','Gwangjin-gu','Gangdong-gu','Gangbuk-gu','Eunpyeong-gu','Dongdaemun-gu','Dobong-gu','Guro-gu')
seoul_gu <- seoul %>%
filter(name_en %in% as.character(unlist(gu)
seoul_gu <- seoul %>%
filter(name_en %in% gu)
seoul_gu <- seoul %>%
filter(name_en %in% gu)
tmap_mode("view")
qtm(seoul_gu,
fill = "population",
text= "name_en",
text.size = 0.8)
clinics <- as_Spatial(clinics)
hospitals <- as_Spatial(hospitals)
